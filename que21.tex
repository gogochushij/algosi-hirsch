\section{(В РАЗРАБОТКЕ) Алгоритм Шоннинга для 3-SAT, использующий случайное блуждание}

Условие задачи все еще \hyperlink{3sat}{\texttt{в том билете}}.

\statement{Вероятностное решение (Sch\"oning, 1999), время $O(n^3(4/3)^n)$, шанс ошибки $\leq (1/2)^n$ }{}

Алгоритм описывается даже проще, чем предыдущие. В начале мы берем случайный $x \in \{0, 1\}^n$. Повторим не более $n$ раз следующее: если $x$ не выполняет формулу, то возьмем в ней случайный ложный конъюнкт, случайно выберем \textbf{одну} переменную в нем и изменим ее значение. Описание алгоритма закончено.

\underline{Оценим снизу вероятность того, что этот алгоритм найдет выполняющий набор} $x^*$. Не уменьшая общности, предположим, что выполняющий набор $x^*$ существует и единственный. Заметим тогда (по \hyperlink{flip20}{\texttt{рассуждению из билета 20}}), что при каждой итерации цикла $x$ становится ближе к $x^*$ с вероятностью $\geq 1/3$ и дальше от $x^*$ с вероятностью $\leq 2/3$. Поэтому, не уменьшая общности, еще предположим, что вероятности приближения и отдаления -- \textbf{ровно} $1/3$ и $2/3$ соответственно.

Итак, вероятность того, что $x$ совпадет с $x^*$, моделируется следующей задачей на случайное блуждание по отрезку $[0, N]$. $x$ начинает свой путь в некоторой точке этого отрезка, делает шаг влево с вероятностью $1/3$, вправо -- с $2/3$ (и все время остается в отрезке $[0, N]$), и необходимо оценить вероятность того, что в течение $n$ шагов он когда-нибудь посетит 0.

Не уменьшая общности, для того, чтобы $x$ посетил 0 в течение $n$ шагов, \textbf{достаточно} (конечно, не необходимо) два условия:
\begin{enumerate}
    \item Случайно выбранный в начале алгоритма $x$ оказался $x^*$ на расстоянии $n/3$ от $x^*$
    \item За $n$ шагов из точки $n/3$ он придет в 0, совершив $2n/3$ шагов влево и $n/3$ шагов вправо, не выходя при этом за границу отрезка 0.
\end{enumerate}

Сейчас мы посчитаем вероятности этих двух событий, их произведение и будет оценкой снизу на вероятность того, что алгоритм найдет выполняющий набор.

Вероятность первого события равна $P_1 = \frac{{n\choose{n/3}}}{2^n}$ так как из $2^n$ равновероятных наборов $\in \{0, 1\}^n$ мы должны выбрать тот, у которого ровно $n/3$ позиций, в которых он и $x^*$ различаются. 

Для подсчета вероятности второго события воспользуемся следующей задачей.

\statement{Теорема (задача о пьянице и канаве).}{Сколько существует путей из точки $S=P-Q>0$ в точку $0$, состоящих ровно из $P$ шагов влево, $Q$ шагов вправо и не выходящих за точку 0? Ответ: $\frac{P-Q}{P+Q} {P+Q\choose P}$.}

(доказательство coming soon????? не хочу писать, в инете есть, в слайдах есть)$\blacksquare$
\needpicture

В нашем случае количество шагов влево $P = 2n/3$, вправо $Q=n/3$, так что всего таких путей $\frac{n/3}{n}{n\choose n/3}$. Для фиксированного пути с $P$ шагами влево и $Q$ шагами вправо вероятность, что $x$ пройдет именно его, равна $(1/3)^P (2/3)^Q = (1/3)^{2n/3} (2/3)^{n/3}$, так что:

$$P_2 = \frac{1}{3} {n\choose n/3} (1/3)^{2n/3} (2/3)^{n/3}$$

\newcommand{\scm}{\overset{\text{c}}{\sim}}
Символом $\scm$ будем обозначать <<эквивалентность с точностью до константы>>, т.е: $$[f \scm g] \iff [\exists C > 0: \; f \sim Cg]$$

С помощью формулы Стирлинга $n! \sim \sqrt{2\pi n}(\frac{n}{e})^n \scm \sqrt{n}(\frac{n}{e})^n$ можно убедиться (или дождаться пока я это посчитаю и напечатаю), что:

$$ P_1 \scm \frac{1}{\sqrt n}(\frac{3}{2^{5/3}})^n$$
$$ P_2 \scm \frac{1}{\sqrt n}(\frac{1}{2^{1/3}})^n$$

И поэтому вероятность успеха асимптотически хотя бы 
$$P \geq P_1 \cdot P_2 \scm \frac{1}{\sqrt n}(\frac{3}{2^{5/3}})^n \cdot \frac{1}{\sqrt n}(\frac{1}{2^{1/3}})^n = \frac{1}{n}(\frac{3}{4})^n$$

Однако этот алгоритм работает за $O(n)$ времени! Его можно повторить много раз, увеличивая шансы на успех. Например, если повторить его $n(4/3)^n = L$ раз, то имеем вероятность неудачи:
$$(1-\frac{1}{L})^L \leq \frac{1}{e} \leq \frac{1}{2}$$
А если повторить в $n$ раз больше, то есть $n^2(4/3)^n$ раз, то вероятность неудачи $\leq (\frac{1}{2})^n$ совсем мала.

Итак, получили алгоритм с временем работы $O(n^3(4/3)^n)$ и вероятностью ошибки $\leq (\frac{1}{2})^n$. Более точно: если алгоритм нашел выполняющий набор, то он точно подходит, а если не нашел, то шансов на то, что на самом деле выполняющий набор существует, очень мало. $\blacksquare$











