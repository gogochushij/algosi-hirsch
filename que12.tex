\hypertarget{Freivalds}{}
\section{(12) Вероятностные алгоритмы с односторонней ограниченной вероятностью ошибки. Алгоритм Фрейвальдса для проверки умножения матриц. (Ермошин И.)}

\subsection{Вероятностные алгоритмы с односторонней ограниченной вероятностью ошибки}

Нам надо что-то проверить. Придумываем алгоритм, который это проверяет, но может ошибиться. Более точно: при истинном успехе алгоритм всегда сообщает об успехе, но при истинной неудаче алгоритм может ошибиться~-- сообщить об успехе с вероятностью $p$. Повторив его 10 раз, получим вероятность ошибки $p^{10}$, что, вероятно(ha ha), гораздо меньше.

\subsection{Алгоритм Фрейвальдса для проверки умножения матриц.}

Есть три матрицы: $A_{m,n}$, $B_{n,k}$ и $C_{m,k}$, хотим узнать $A\times B=C$ или нет

\begin{algodescription}{Решение за $O\left(\frac{mnk}{\min(m,n,k)}\right)$ с вероятностью ошибки $\le\frac{1}{2}$}

\statement{NB:}{Если все матрицы $A$, $B$, $C$ квадратные, то мы проверим за $O(n^2)$, а если бы проверяли умножением матриц - это $O(n^{2.8})$ (алгоритм Штрассена)}

Сгенерируем случайный столбец $r$ длины $k$ из нулей и единиц (все равновероятно). Давайте проверять равенство $AB\times r=C\times r$; если умножать так: $A\times (B\times r)$, получится время $O(nk+mn+mk)=O\left(\frac{mnk}{\min(m,n,k)}\right)$, где каждое слагаемое есть время перемножения матриц $B\times r$, $A \times Br$ и $C\times r$.
\end{algodescription}

Очевидно, если $A\times B=C$, алгоритм так и сообщит. Следующая теорема~-- о том, с какой вероятностью алгоритм ошибется, сообщив о равенстве, когда его нет.

\begin{theorem*} 
    При $A\times B \neq C$ для случайно выбранного вектора $r$ вероятность того, что $AB\times r = C\times r$, не превосходит $\frac{1}{2}$.
\end{theorem*}
\begin{proof}
Перепишем $ABr = Cr$ как $Xr=0$, $X=AB-C$. Посмотрим на какой-нибудь ненулевой элемент $x_{kl}$. Имеем:
$$\sum_{i=1, i\ne l}^{n} x_{ki}r_i+x_{kl}r_l=0$$
Из этого выражения однозначно определяется $r_l$. Это означает, что уже векторов $r$, удовлетворяющих $Xr=0$, не более $2^{k-1}$, а шанс выбрать такой вектор не превосходит $\frac{2^{k-1}}{2^k} = \frac{1}{2}$. Таким образом, вероятность ошибки $\le\frac{1}{2}$. \end{proof}
