\section{(4) Приближенный алгоритм для задачи о рюкзаке (Осипов Д.)}
Напомним сначала классическое, точное решение задачи о рюкзаке методом динамического программирования.

\begin{problem*}[о рюкзаке с повторениями]
	Пусть есть $n$ видов вещей, $i-$тая вещь имеет вес $w_i$ и стоимость $v_i$. Количество каждого вида вещей неограничено. Пусть $W$~-- максимальный вес, который выдерживает рюкзак. Найти максимальную стоимость по всем наборам вещей, суммарный вес которого не превышает $W$.
\end{problem*}

\begin{algodescription}{Точное решение за $O\left(n\sum{v_i}=nV\right)$} Динамическое программирование. Пусть $K[v]$~-- минимальный вес набора стоимостью ровно $v$. Тогда $K[0] = 0$, $K[v] = \underset{i=0}{\overset{n}{\min}} \{K[v-v_i] + w_i\}$. Ответ на задачу: $\max\{v : K[v] \leq W\}$.

Таким образом заполняется массив длины $V+1$, на каждый поиск минимума уходит $O(n)$ времени, на поиск ответа $O(n)$, всего $O(nV)$. 
\end{algodescription}

Теперь рассмотрим решение, которое может выдавать решение с заданной точностью. Именно, для всякого $0 < \e < 1$ это решение будет работать за $O(\frac{n^3}{\e})$ времени, а ценность найденного набора будет отличаться от оптимальной на множитель, не превышающий $(1-\e)$.

\begin{algodescription}{Приближенное $\frac{1}{1-\e}$-оптимальное решение за $O\left(\frac{n^3}{\e}\right)$}

Зафиксируем параметр $\e>0$. Заменим все $v_i$ на: $$\hat{v_i} = \left[\frac{n}{\e} \cdot \frac{v_i}{v_{max}}\right]$$ Запустим на новом наборе алгоритм ДП выше. 
\end{algodescription}

\begin{theorem*}
    Время работы этого алгоритма есть $O\left(\frac{n^3}{\e}\right)$
\end{theorem*}
\begin{proof}
    $V = \sum v_i \leq n\cdot \frac{n}{\e} = \frac{n^2}{\e}$. Поэтому время $O\left(n \cdot \frac{n^2}{\e}\right) = O\left(\frac{n^3}{\e}\right)$.
\end{proof}

\begin{theorem*}
    Это действительно $\frac{1}{1-\e}$-оптимальный алгоритм.
\end{theorem*}
\begin{proof}
Пусть оптимальное решение исходной задачи~-- набор $S$, его стоимость с точки зрения старой задачи $K^* = \sum\limits_{i\in S} v_i$.

С точки зрения новой задачи сумма этого набора оценивается как:
$$\sum_{i\in S}\hat{v_i} = \sum_{i\in S} \left[\frac{v_i n}{\e v_{max}}\right] \geq \sum_{i\in S} \left(v_i \cdot \frac{n}{\e v_{max}} - 1\right) \geq K^*\frac{n}{\e v_{max}} - n$$

С точки зрения новой задачи набор $S$ необязательно оптимален. То есть, если $\hat{S}$~-- оптимальный с точки зрения новой задачи набор, то имеем $$\sum_{i\in\hat S}\hat{v_i} \geq \sum_{i\in S} \hat{v_i} \geq K^*\frac{n}{\e v_{max}} - n$$

Нужно оценить, насколько стоимости наборов $S$ и $\hat S$ отличаются с точки зрения старой задачи, т.е. сравнить величины $\sum\limits_{i\in S}v_i = K^*$ и $\sum\limits_{i\in\hat S}v_i$. Что же, так как $\hat{v_i} \leq \frac{v_i n}{\e v_{max}}$,

$$\sum_{i\in\hat S}v_i \geq \sum_{i\in\hat S} \hat{v_i} \frac{\e v_{max}}{n} \geq \left(K^*\frac{n}{\e v_{max}} - n\right)\frac{\e v_{max}}{n} = K^* - \e v_{max} \geq K^* - \e K^* = K^*(1-\e)$$

Таким образом, полученное решение  хуже оптимального не более, чем в $\frac{1}{1-\e}$ раз. 
\end{proof}
