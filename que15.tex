\section{(15) Проверка равенства полиномов. Лемма Шварца-Циппеля. (Ермошин И.)}

\begin{lemma*}[Шварца-Зиппеля]
	$0\ne p\in\mathbb{Z}[x_1,\ldots,x_m]$, все $\deg x_i\le d, A\subset\mathbb{Z}, |A|<\infty$. Тогда $$\left|\{(i_1,\ldots,i_m)\in A^m\colon p(i_1,\ldots,i_m)=0\}\right|\le md|A|^{m-1}$$
\end{lemma*}
\begin{proof}
Докажем индукцией по количеству переменных: при $m=1$, очевидно, корней $\le d$.

Переход:
Очевидно, можно написать $p(x_1,\ldots,x_m)=x_m^d\cdot y_d+\cdots+x_m^0\cdot y_0,$ где $\{y_i\}\subset \mathbb Z[x_1,\ldots,x_{m-1}]$. Оценим число корней $x = (x_1, \ldots, x_m)$, рассмотрев два случая:
\begin{enumerate}
\item $x$ обнуляет $y_d$. Таких корней $\le (m-1)d|A|^{m-2} \cdot |A|$ (выберем $x_1,\ldots,x_{m-1}$ по предположению индукции $\le(m-1)d|A|^{m-2}$ способами и возьмем в качестве $x_m$ любое число из $A$).
\item $x$ не обнуляет $y_d$. Тогда при подстановке $x_1, \ldots, x_{m-1}$ получится ненулевой многочлен от $x_m$. У него корней не больше, чем $d$. Оценим грубо: всего наборов $(x_1, \ldots, x_{m-1})$ значений $|A|^{m-1}$ штук, значит корней $\le d|A|^{m-1}$.
\end{enumerate}

Итого $\le (m-1)d|A|^{m-1}+d|A|^{m-1}=md|A|^{m-1}.$
\end{proof}

\begin{problem*}
	Даны два многочлена $p_1$ и $p_2$. Выяснить, равны ли они.
\end{problem*}

Считается, что многочлены достаточно большие и даны в таком виде, что приведение к каноническому виду $p = a_d x^d + \cdots + a_0$ очень затруднено, но вычисление значений многочленов в точках возможно. Например, если многочлен задан разложением на множители $p = (x-x_1)\ldots(x-x_d)$, для раскытия скобок и приведения подобных нужно сделать $O(2^d)$ действий, но вычислить значение в точке можно за $O(d)$.

\begin{algodescription}{Алгоритм} За полином от длины вычислим $m$~-- количество переменных, $d = \max\text{deg } x_i$. Зафиксируем некоторое конечное $A \subseteq \mathbb Z$. Выберем случайно $x \in A^m$ и вычислим значения $p_1(x), p_2(x)$. Если $p_1(x) = p_2(x)$, то ответим <<многочлены совпадают>>, иначе~-- <<многочлены не совпадают>>. 
\end{algodescription}

Ясно, что если $p_1=p_2$, то алгоритм об этом и сообщит. Следующая теорема вычисляет вероятность ошибки. 
\begin{theorem*}
Вероятность того, что при случайно выбранном конечном $A\subseteq \mathbb Z$ верно $p_1 \neq p_2$, но $p_1(x) = p_2(x)$, не превосходит $\frac{md}{|A|}$.
\end{theorem*}
\begin{proof}
    По лемме знаем, что у $p_1-p_2$ не более $md|A|^{m-1}$ корней, таким образом, вероятность попасть в корень не превосходит: $$\leq \frac{md|A|^{m-1}}{|A|^m} = \frac{md}{|A|}$$ Ясно, что это и есть вероятность $p_1(x)=p_2(x)$ при $p_1 \neq p_2$. 
\end{proof}

\begin{nb*} Размер выбранного конечного $A$ влияет на вероятность ошибки, но не влияет на время работы алгоритма. Таким образом, требуемая малость вероятности ошибки может достигаться не только повторением алгоритма, но и размером $A$.
\end{nb*}